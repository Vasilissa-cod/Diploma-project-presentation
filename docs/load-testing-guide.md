# РУКОВОДСТВО ПО НАГРУЗОЧНОМУ ТЕСТИРОВАНИЮ
## Тестирование главной страницы FatSecret (https://foods.fatsecret.com/Default.aspx)

---

## ЦЕЛЬ ТЕСТИРОВАНИЯ

Провести нагрузочное и стрессовое тестирование главной страницы веб-приложения FatSecret для оценки производительности системы под различными нагрузками.

---

## ИНСТРУМЕНТЫ

- **Apache JMeter 5.6.3** (или новее)
- **Chrome DevTools** (для дополнительного анализа)
- **Браузер Chrome** (для предварительной проверки)

---

## ПРЕДВАРИТЕЛЬНАЯ ПРОВЕРКА

### Шаг 1: Проверка доступности сайта

1. Откройте браузер Chrome
2. Перейдите по адресу: https://foods.fatsecret.com/Default.aspx
3. Убедитесь, что страница загружается корректно
4. Откройте Chrome DevTools (F12) → вкладка **Network**
5. Перезагрузите страницу (F5)
6. Зафиксируйте:
   - Время загрузки страницы
   - Количество запросов
   - Размер загружаемых ресурсов
   - Основные эндпоинты (URL запросов)

### Шаг 2: Анализ структуры страницы

1. В Chrome DevTools → вкладка **Network** найдите основные запросы:
   - Главный HTML документ: `Default.aspx`
   - CSS файлы
   - JavaScript файлы
   - Изображения
   - API запросы (если есть)

2. Зафиксируйте основные URL для тестирования:
   - Главная страница: `https://foods.fatsecret.com/Default.aspx`
   - Дополнительные эндпоинты (если обнаружены)

---

## НАСТРОЙКА APACHE JMETER

### Шаг 3: Установка и запуск JMeter

1. Убедитесь, что Apache JMeter установлен
2. Запустите JMeter:
   - Windows: Запустите `jmeter.bat` из папки `bin`
   - Или через командную строку: `jmeter`

### Шаг 4: Создание нового тест-плана

1. В JMeter выберите **File → New** (или используйте Ctrl+N)
2. Сохраните тест-план: **File → Save Test Plan As...**
3. Назовите файл: `FatSecret_Load_Test.jmx`
4. Сохраните в папку проекта

### Шаг 5: Настройка Test Plan

1. В дереве элементов выберите **Test Plan**
2. В правой панели настройте:
   - **Name:** `FatSecret Load Test - Main Page`
   - **Comments:** `Нагрузочное тестирование главной страницы FatSecret`

3. **User Defined Variables** (опционально):
   - Нажмите **Add** для добавления переменных
   - Добавьте переменную:
     - **Name:** `base_url`
     - **Value:** `https://foods.fatsecret.com`

### Шаг 6: Добавление Thread Group (Группа потоков)

1. Правой кнопкой на **Test Plan** → **Add → Threads (Users) → Thread Group**
2. Настройте Thread Group:

   **Для Теста 1: Нагрузочное тестирование (10 пользователей)**
   - **Name:** `Load Test - 10 Users`
   - **Number of Threads (users):** `10`
   - **Ramp-up Period (seconds):** `10` (10 секунд для постепенного увеличения нагрузки)
   - **Loop Count:** `6` (6 итераций = 1 минута при 10 секундах на итерацию)
   - Или выберите **Forever** и установите **Duration (seconds):** `60`

   **Для Теста 2: Стресс-тестирование (50 пользователей)**
   - **Name:** `Stress Test - 50 Users`
   - **Number of Threads (users):** `50`
   - **Ramp-up Period (seconds):** `60` (1 минута для постепенного увеличения)
   - **Duration (seconds):** `300` (5 минут)
   - Или **Loop Count:** `30` (30 итераций)

### Шаг 7: Добавление HTTP Request Defaults

1. Правой кнопкой на **Thread Group** → **Add → Config Element → HTTP Request Defaults**
2. Настройте:
   - **Name:** `HTTP Request Defaults`
   - **Server Name or IP:** `foods.fatsecret.com`
   - **Protocol:** `https`
   - **Port Number:** `443` (или оставьте пустым)

### Шаг 8: Добавление HTTP Request (Запрос главной страницы)

1. Правой кнопкой на **Thread Group** → **Add → Sampler → HTTP Request**
2. Настройте:
   - **Name:** `Main Page - Default.aspx`
   - **Method:** `GET`
   - **Path:** `/Default.aspx`
   - **Follow Redirects:** ✓ (включено)
   - **Use KeepAlive:** ✓ (включено)

### Шаг 9: Добавление HTTP Header Manager

1. Правой кнопкой на **HTTP Request** → **Add → Config Element → HTTP Header Manager**
2. Настройте заголовки:
   - **Name:** `HTTP Header Manager`
   - Добавьте заголовки:
     - **Name:** `User-Agent`, **Value:** `Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36`
     - **Name:** `Accept`, **Value:** `text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8`
     - **Name:** `Accept-Language`, **Value:** `ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7`
     - **Name:** `Accept-Encoding`, **Value:** `gzip, deflate, br`
     - **Name:** `Connection`, **Value:** `keep-alive`

### Шаг 10: Добавление Listeners (Слушателей результатов)

#### 10.1. View Results Tree (для отладки)

1. Правой кнопкой на **Thread Group** → **Add → Listener → View Results Tree**
2. Настройте:
   - **Name:** `View Results Tree`
   - **Write results to file / Read from file:** (опционально, для сохранения результатов)

**⚠️ ВАЖНО:** View Results Tree потребляет много памяти. Используйте только для отладки небольших тестов. Для больших тестов отключите или удалите этот listener.

#### 10.2. Summary Report

1. Правой кнопкой на **Thread Group** → **Add → Listener → Summary Report**
2. Настройка не требуется, будет показывать сводную статистику

#### 10.3. Aggregate Report

1. Правой кнопкой на **Thread Group** → **Add → Listener → Aggregate Report**
2. Настройка не требуется, покажет детальную статистику

#### 10.4. Graph Results (опционально)

1. Правой кнопкой на **Thread Group** → **Add → Listener → Graph Results`
2. Покажет график производительности в реальном времени

#### 10.5. Save Responses to a file (для анализа ответов)

1. Правой кнопкой на **HTTP Request** → **Add → Listener → Save Responses to a file`
2. Настройте:
   - **Filename prefix:** `response_`
   - **Add timestamp:** ✓

---

## ВЫПОЛНЕНИЕ ТЕСТИРОВАНИЯ

### Шаг 11: Подготовка к запуску

1. **Отключите View Results Tree** для больших тестов (правой кнопкой → Disable)
2. Сохраните тест-план: **File → Save** (Ctrl+S)
3. Убедитесь, что выбрана правильная Thread Group

### Шаг 12: Запуск Теста 1 (Нагрузочное тестирование - 10 пользователей)

1. В дереве элементов выберите Thread Group `Load Test - 10 Users`
2. Убедитесь, что другие Thread Groups отключены (правой кнопкой → Disable)
3. Нажмите кнопку **▶ Start** (зеленая кнопка в верхней панели)
4. Или используйте меню: **Run → Start**
5. Наблюдайте за выполнением теста
6. Дождитесь завершения теста

### Шаг 13: Анализ результатов Теста 1

После завершения теста проанализируйте результаты в Listeners:

**Summary Report:**
- **Samples:** Количество выполненных запросов
- **Average:** Среднее время отклика (в миллисекундах)
- **Min:** Минимальное время отклика
- **Max:** Максимальное время отклика
- **Error %:** Процент ошибок
- **Throughput:** Пропускная способность (запросов в секунду)

**Ожидаемые результаты:**
- Среднее время отклика: < 2000 мс (2 секунды)
- Процент ошибок: 0%
- Пропускная способность: > 5 запросов/сек

### Шаг 14: Запуск Теста 2 (Стресс-тестирование - 50 пользователей)

1. Отключите Thread Group `Load Test - 10 Users`
2. Включите Thread Group `Stress Test - 50 Users`
3. Нажмите **▶ Start**
4. Дождитесь завершения теста (5 минут)

### Шаг 15: Анализ результатов Теста 2

Проанализируйте результаты аналогично Тесту 1.

**Ожидаемые результаты:**
- Среднее время отклика: < 3000 мс (3 секунды)
- Процент ошибок: < 1%
- Система должна оставаться стабильной

---

## СОХРАНЕНИЕ РЕЗУЛЬТАТОВ

### Шаг 16: Экспорт результатов

1. В **Summary Report** или **Aggregate Report**:
   - Правой кнопкой → **Save Table Data**
   - Сохраните как CSV файл: `load_test_results_10_users.csv` и `stress_test_results_50_users.csv`

2. В **Graph Results** (если использовали):
   - Правой кнопкой → **Save Graph as PNG**
   - Сохраните графики производительности

3. Сохраните скриншоты Listeners для документации

---

## ДОКУМЕНТИРОВАНИЕ РЕЗУЛЬТАТОВ

### Шаг 17: Создание отчета

Создайте документ с результатами тестирования:

**Структура отчета:**

1. **Информация о тестировании:**
   - Дата и время тестирования
   - Версия JMeter
   - Тестируемый URL
   - Параметры тестов

2. **Результаты Теста 1 (10 пользователей):**
   - Количество запросов (Samples)
   - Среднее время отклика (Average)
   - Минимальное время отклика (Min)
   - Максимальное время отклика (Max)
   - Процент ошибок (Error %)
   - Пропускная способность (Throughput)
   - Статус: ✅ Пройден / ❌ Провален

3. **Результаты Теста 2 (50 пользователей):**
   - Аналогичные метрики
   - Анализ стабильности системы
   - Статус: ✅ Пройден / ❌ Провален

4. **Выводы и рекомендации:**
   - Оценка производительности
   - Выявленные проблемы (если есть)
   - Рекомендации по оптимизации

---

## ДОПОЛНИТЕЛЬНЫЕ НАСТРОЙКИ

### Оптимизация для больших тестов

1. **Увеличьте память JMeter:**
   - Отредактируйте файл `jmeter.bat`
   - Найдите строку с `HEAP`
   - Установите: `set HEAP=-Xms1g -Xmx4g -XX:MaxMetaspaceSize=256m`

2. **Используйте режим командной строки для больших тестов:**
   ```bash
   jmeter -n -t FatSecret_Load_Test.jmx -l results.jtl -e -o report/
   ```
   Где:
   - `-n` - не-GUI режим
   - `-t` - тест-план
   - `-l` - файл результатов
   - `-e` - создать HTML отчет
   - `-o` - папка для отчета

### Добавление дополнительных сценариев

1. **Тест поиска продуктов:**
   - Добавьте HTTP Request для поиска: `/Diary.aspx?pa=fj&q=chicken`
   - Используйте переменные для разных поисковых запросов

2. **Тест авторизации:**
   - Добавьте HTTP Request для POST запроса авторизации
   - Используйте HTTP Cookie Manager для управления сессиями

---

## ЧАСТО ВСТРЕЧАЮЩИЕСЯ ПРОБЛЕМЫ

### Проблема 1: "Address already in use"

**Решение:** Закройте другие экземпляры JMeter или измените порт в настройках.

### Проблема 2: "Out of memory"

**Решение:** Увеличьте память JMeter (см. раздел "Оптимизация").

### Проблема 3: Все запросы возвращают ошибки

**Решение:** 
- Проверьте правильность URL
- Проверьте настройки HTTP Request Defaults
- Убедитесь, что сайт доступен
- Проверьте заголовки запросов

### Проблема 4: Низкая производительность теста

**Решение:**
- Отключите View Results Tree
- Используйте не-GUI режим
- Увеличьте память JMeter
- Упростите тест-план

---

## СЛЕДУЮЩИЕ ШАГИ

После выполнения тестирования:

1. Проанализируйте результаты
2. Сравните с ожидаемыми значениями
3. Создайте отчет с выводами
4. Задокументируйте найденные проблемы (если есть)
5. Подготовьте рекомендации по оптимизации

---

## ПРИМЕЧАНИЯ

- ⚠️ **Важно:** Не проводите нагрузочное тестирование без разрешения владельца сайта
- Для тестирования используйте тестовую среду или получите разрешение
- Нагрузочное тестирование может создать значительную нагрузку на сервер
- Рекомендуется проводить тесты в нерабочее время или на тестовой среде

---

*Документ создан для дипломной работы по тестированию веб-приложения FatSecret*

